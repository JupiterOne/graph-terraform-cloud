---
sourceId: managed:terraform
integrationDefinitionId: '${integration_definition_id}'
questions: 
- id: integration-question-terraform-cloud-users-with-no-multi-factor-authentication
  title: Returns a list of Terraform Cloud users that do not use MFA working independently or within a Terraform team workspace?
  description:
    Find Terraform Cloud users that do not use mfa internally or when accessing a Terraform organization workspace.
  queries: 
  - name: bad 
    query: |
      FIND tfe_user AS user
        THAT HAS tfe_organization AS org 
      RETURN
      user.displayName,user.mfaEnabled,user.mfaVerified,org.mfaEnabled    
  tags:
  - terraform-cloud
  - workspace